<!DOCTYPE html>
<html lang="en" class="loading">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>TapWord Settings</title>
  <link rel="stylesheet" href="styles.css" />
</head>
<body>
  <div class="container">
    <header class="header">
      <div class="logo">
        <img src="/resources/icons/icon-128.png" alt="TapWord logo" class="logo-image" />
        <div class="logo-text">
          <div class="title-wrapper">
            <h1 class="app-name" data-i18n-key="popup.title">TapWord</h1>
            <span class="app-subtitle" id="communitySubtitle" data-i18n-key="popup.communityEdition" style="display: none;">Community Edition</span>
            <span class="version" id="versionDisplay"></span>
          </div>
        </div>
      </div>
      <div class="header-actions">
        <button class="secondary-button" id="documentationButton" data-i18n-key="popup.websiteLink">访问官网</button>
        <button class="secondary-button github-button" id="githubButton" title="GitHub">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" width="20" height="20">
            <path d="M12 2C6.477 2 2 6.477 2 12c0 4.418 2.865 8.166 6.839 9.489.5.092.682-.217.682-.482 0-.237-.008-.868-.013-1.703-2.782.605-3.369-1.34-3.369-1.34-.454-1.156-1.11-1.463-1.11-1.463-.908-.62.069-.608.069-.608 1.003.07 1.531 1.03 1.531 1.03.892 1.529 2.341 1.087 2.91.832.092-.647.35-1.088.636-1.338-2.22-.253-4.555-1.11-4.555-4.943 0-1.091.39-1.984 1.029-2.683-.103-.253-.446-1.27.098-2.647 0 0 .84-.269 2.75 1.025A9.564 9.564 0 0112 6.844c.85.004 1.705.115 2.504.337 1.909-1.294 2.747-1.025 2.747-1.025.546 1.377.203 2.394.1 2.647.64.699 1.028 1.592 1.028 2.683 0 3.842-2.339 4.687-4.566 4.935.359.309.678.92.678 1.855 0 1.338-.012 2.419-.012 2.747 0 .268.18.58.688.482C19.138 20.161 22 16.418 22 12c0-5.523-4.477-10-10-10z"></path>
          </svg>
          <span>GitHub</span>
        </button>
      </div>
    </header>
    <main class="main-content">
      <aside class="sidebar">
        <nav class="nav-menu">
          <a href="#general-settings" class="nav-item active" data-section="general-settings" data-i18n-key="popup.section.general">General</a>
          <a href="#translation-settings" class="nav-item" data-section="translation-settings" data-i18n-key="popup.section.translate">Translation</a>
          <a href="#display-settings" class="nav-item" data-section="display-settings" data-i18n-key="popup.section.text">Text</a>
          <a href="#audio-settings" class="nav-item" data-section="audio-settings" data-i18n-key="popup.section.audio">Audio</a>
          <a href="#appearance-settings" class="nav-item" data-section="appearance-settings" data-i18n-key="popup.section.appearance">Appearance</a>
          <a href="#advanced-settings" class="nav-item" data-section="advanced-settings" data-i18n-key="popup.section.advanced">Advanced</a>
        </nav>
      </aside>
      <section class="content">
        <div id="general-settings" class="settings-section active">
          <div class="section-header">
            <h2 data-i18n-key="popup.section.general">General</h2>
          </div>
          <div class="card settings-card">
            <div class="setting-item setting-item-master">
              <div class="setting-info">
                <label class="setting-label master-label" for="enableTapWord">
                  <span data-i18n-key="popup.enableTapWord.label">Enable TapWord</span>
                </label>
                <p class="setting-helper" data-i18n-key="popup.enableTapWord.helper">Turn off to temporarily disable all translation actions.</p>
              </div>
              <label class="toggle-switch toggle-switch-master">
                <input type="checkbox" id="enableTapWord" data-setting="enableTapWord">
                <span class="toggle-slider"></span>
              </label>
            </div>
            <div class="setting-item">
              <div class="setting-info">
                <label class="setting-label" for="targetLanguage" data-i18n-key="popup.targetLanguage.label">Target Language</label>
              </div>
              <div class="setting-control">
                <select id="targetLanguage" data-setting="targetLanguage" class="select-input">
                  <option value="en">English</option>
                  <option value="zh">中文</option>
                  <option value="es">Español</option>
                  <option value="ja">日本語</option>
                  <option value="fr">Français</option>
                  <option value="de">Deutsch</option>
                  <option value="ko">한국어</option>
                  <option value="ru">Русский</option>
                </select>
              </div>
            </div>
            <div class="setting-item">
              <div class="setting-info">
                <label class="setting-label" for="showIcon">
                  <span data-i18n-key="popup.showIcon.label">Show Translation Icon</span>
                </label>
                <p class="setting-helper" data-i18n-key="popup.showIcon.tooltip">Show a floating translate icon near selected text.</p>
              </div>
              <label class="toggle-switch">
                <input type="checkbox" id="showIcon" data-setting="showIcon">
                <span class="toggle-slider"></span>
              </label>
            </div>
            <div class="setting-item">
              <span class="feature-dot" title="Important feature"></span>
              <div class="setting-info">
                <label class="setting-label" for="singleClickTranslate" data-i18n-key="popup.singleClickTranslate.label">Single-click to Translate</label>
              </div>
              <label class="toggle-switch toggle-switch-pink">
                <input type="checkbox" id="singleClickTranslate" data-setting="singleClickTranslate">
                <span class="toggle-slider"></span>
              </label>
            </div>
            <div class="setting-item">
              <div class="setting-info">
                <label class="setting-label" for="doubleClickTranslateV2" data-i18n-key="popup.doubleClickTranslate.label">Double-click to Translate</label>
              </div>
              <label class="toggle-switch">
                <input type="checkbox" id="doubleClickTranslateV2" data-setting="doubleClickTranslateV2">
                <span class="toggle-slider"></span>
              </label>
            </div>
            <div class="setting-item" id="settingItem-doubleClickSentence">
              <div class="setting-info">
                <div class="trigger-key-container" style="display: flex; align-items: center; gap: 8px; margin-bottom: 4px;">
                  <select id="doubleClickSentenceTriggerKey" data-setting="doubleClickSentenceTriggerKey" class="select-input trigger-key-select" style="width: auto; padding: 4px 8px;">
                    <!-- Options populated by JS -->
                  </select>
                  <span class="plus-separator">+</span>
                  <label class="setting-label" for="doubleClickSentenceTranslate" data-i18n-key="popup.doubleClickSentenceTranslate.label" style="margin-bottom: 0;">Double-click Sentence</label>
                </div>
                <p class="setting-helper" data-i18n-key="popup.doubleClickSentenceTranslate.tooltip">Translate the whole sentence when double-clicking with a modifier key.</p>
              </div>
              <label class="toggle-switch">
                <input type="checkbox" id="doubleClickSentenceTranslate" data-setting="doubleClickSentenceTranslate">
                <span class="toggle-slider"></span>
              </label>
            </div>
          </div>
        </div>

        <div id="translation-settings" class="settings-section">
          <div class="section-header">
            <h2 data-i18n-key="popup.section.translate">Translation Settings</h2>
          </div>
          <div class="card settings-card">
            <div class="setting-item">
              <div class="setting-info">
                <label class="setting-label" for="suppressNativeLanguage">
                  <span id="suppressNativeLanguageLabel"></span>
                </label>
                <p class="setting-helper" data-i18n-key="popup.suppressNativeLanguage.tooltip">Don't show translation icon when text language matches target language.</p>
              </div>
              <label class="toggle-switch">
                <input type="checkbox" id="suppressNativeLanguage" data-setting="suppressNativeLanguage">
                <span class="toggle-slider"></span>
              </label>
            </div>
          </div>
        </div>

        <div id="display-settings" class="settings-section">
          <div class="section-header">
            <h2 data-i18n-key="popup.section.text">Text Settings</h2>
          </div>
          <div class="card settings-card">
            <div class="setting-item">
              <div class="setting-info">
                <label class="setting-label" for="translationFontSizePreset" data-i18n-key="popup.translationFontSize.label">Translation Font Size</label>
              </div>
              <div class="setting-control">
                <select id="translationFontSizePreset" data-setting="translationFontSizePreset" class="select-input">
                  <option value="small" data-i18n-key="popup.translationFontSize.small">Small</option>
                  <option value="medium" data-i18n-key="popup.translationFontSize.medium">Medium</option>
                  <option value="large" data-i18n-key="popup.translationFontSize.large">Large</option>
                  <option value="extraLarge" data-i18n-key="popup.translationFontSize.extraLarge">Extra Large</option>
                </select>
              </div>
            </div>
            <div class="setting-item">
              <div class="setting-info">
                <label class="setting-label" for="autoAdjustHeight">
                  <span data-i18n-key="popup.autoAdjustHeight.label">Auto-adjust Line Height</span>
                </label>
                <p class="setting-helper" data-i18n-key="popup.autoAdjustHeight.tooltip">Improve readability by gently increasing line height for translated text.</p>
              </div>
              <label class="toggle-switch">
                <input type="checkbox" id="autoAdjustHeight" data-setting="autoAdjustHeight">
                <span class="toggle-slider"></span>
              </label>
            </div>

            <div class="setting-item">
              <div class="setting-info">
                <label class="setting-label" for="restoreLineHeightOnClear">
                  <span data-i18n-key="popup.restoreLineHeightOnClear.label">Restore line height on clear</span>
                </label>
                <p class="setting-helper" data-i18n-key="popup.restoreLineHeightOnClear.tooltip">Restore original line height when all translations in a block are removed.</p>
              </div>
              <label class="toggle-switch">
                <input type="checkbox" id="restoreLineHeightOnClear" data-setting="restoreLineHeightOnClear">
                <span class="toggle-slider"></span>
              </label>
            </div>

            <div class="setting-item">
              <div class="setting-info">
                <label class="setting-label" for="tooltipNextLineGapPxV2" data-i18n-key="popup.tooltipNextLineGapPx.label">Tooltip Next-line Gap (px)</label>
                <p class="setting-helper" data-i18n-key="popup.tooltipNextLineGapPx.helper">Extra spacing reserved between the tooltip and the next line of text.</p>
              </div>
              <div class="setting-control">
                <input type="number" id="tooltipNextLineGapPxV2" data-setting="tooltipNextLineGapPxV2" class="select-input" step="1" min="0" max="20" />
                <p class="input-warning" id="tooltipNextLineGapPxV2Warning" data-i18n-key="popup.tooltipNextLineGapPx.warning">Value must be between 0 and 20</p>
              </div>
            </div>

            <div class="setting-item">
              <div class="setting-info">
                <label class="setting-label" for="tooltipVerticalOffsetPxV2" data-i18n-key="popup.tooltipVerticalOffsetPx.label">Tooltip Vertical Offset (px)</label>
                <p class="setting-helper" data-i18n-key="popup.tooltipVerticalOffsetPx.helper">Moves the tooltip up/down relative to the selected text (negative pulls upward).</p>
              </div>
              <div class="setting-control">
                <input type="number" id="tooltipVerticalOffsetPxV2" data-setting="tooltipVerticalOffsetPxV2" class="select-input" step="1" min="0" max="20" />
                <p class="input-warning" id="tooltipVerticalOffsetPxV2Warning" data-i18n-key="popup.tooltipVerticalOffsetPx.warning">Value must be between 0 and 20</p>
              </div>
            </div>

            <div class="setting-item">
              <div class="setting-info">
                <label class="setting-label" for="textUnderlineOffsetPxV2" data-i18n-key="popup.textUnderlineOffsetPx.label">Underline Offset (px)</label>
                <p class="setting-helper" data-i18n-key="popup.textUnderlineOffsetPx.helper">Adjust the distance between the text and the underline.</p>
              </div>
              <div class="setting-control">
                <input type="number" id="textUnderlineOffsetPxV2" data-setting="textUnderlineOffsetPxV2" class="select-input" step="1" min="0" max="20" />
                <p class="input-warning" id="textUnderlineOffsetPxV2Warning" data-i18n-key="popup.textUnderlineOffsetPx.warning">Value must be between 0 and 20</p>
              </div>
            </div>

            <div class="tooltip-preview" id="tooltipPreview">
              <div class="tooltip-preview-stage" id="tooltipPreviewStage">
                <p class="tooltip-preview-paragraph" id="tooltipPreviewParagraph">
                  <span data-i18n-key="popup.preview.text1">The new AI model can</span> <span class="tooltip-preview-anchor tooltip-preview-anchor--word" id="tooltipPreviewAnchor1" data-i18n-key="popup.preview.word">comprehend</span> <span class="tooltip-preview-anchor tooltip-preview-anchor--phrase" id="tooltipPreviewAnchor" data-i18n-key="popup.preview.phrase">complex instructions</span><span data-i18n-key="popup.preview.text2">.</span>
                  <br />
                  <span data-i18n-key="popup.preview.nextLine">Users have reported significant improvements in accuracy.</span>
                </p>
                <div class="tooltip-preview-tooltip" id="tooltipPreviewTooltip1" data-i18n-key="popup.preview.wordTranslation">理解</div>
                <div class="tooltip-preview-tooltip" id="tooltipPreviewTooltip" data-i18n-key="popup.preview.phraseTranslation">复杂的指令</div>
              </div>
            </div>
          </div>
        </div>

        <div id="audio-settings" class="settings-section">
          <div class="section-header">
            <h2 data-i18n-key="popup.section.audio">Audio Settings</h2>
          </div>
          <div class="card settings-card">
            <div class="setting-item" id="autoPlayAudioSettingItem">
              <div class="setting-info">
                <label class="setting-label" for="autoPlayAudio" data-i18n-key="popup.autoPlayAudio.label">Auto-play Word Pronunciation</label>
                <p class="setting-helper community-note" id="autoPlayAudioCommunityNote"></p>
              </div>
              <label class="toggle-switch">
                <input type="checkbox" id="autoPlayAudio" data-setting="autoPlayAudio">
                <span class="toggle-slider"></span>
              </label>
            </div>
          </div>
        </div>

        <div id="appearance-settings" class="settings-section">
          <div class="section-header">
            <h2 data-i18n-key="popup.section.appearance">Appearance Settings</h2>
          </div>
          <div class="card settings-card">
            <div class="setting-item">
              <div class="setting-info">
                <label class="setting-label" data-i18n-key="popup.iconColor.label">Icon Color</label>
              </div>
            </div>
            <div class="icon-picker-container">
              <label class="icon-option">
                <input type="radio" name="iconColor" value="pink" data-setting="iconColor">
                <span class="icon-preview">
                  <svg width="32" height="32" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <circle cx="12" cy="12" r="10" fill="#F472B6" opacity="0.85"/>
                    <path d="M8 9L11 12L8 15M14 9L17 12L14 15" stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                  </svg>
                </span>
              </label>
              <label class="icon-option">
                <input type="radio" name="iconColor" value="blue" data-setting="iconColor">
                <span class="icon-preview">
                  <svg width="32" height="32" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <circle cx="12" cy="12" r="10" fill="#60A5FA" opacity="0.85"/>
                    <path d="M8 9L11 12L8 15M14 9L17 12L14 15" stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                  </svg>
                </span>
              </label>
              <label class="icon-option">
                <input type="radio" name="iconColor" value="purple" data-setting="iconColor">
                <span class="icon-preview">
                  <svg width="32" height="32" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <circle cx="12" cy="12" r="10" fill="#A78BFA" opacity="0.85"/>
                    <path d="M8 9L11 12L8 15M14 9L17 12L14 15" stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                  </svg>
                </span>
              </label>
              <label class="icon-option">
                <input type="radio" name="iconColor" value="green" data-setting="iconColor">
                <span class="icon-preview">
                  <svg width="32" height="32" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <circle cx="12" cy="12" r="10" fill="#4ADE80" opacity="0.85"/>
                    <path d="M8 9L11 12L8 15M14 9L17 12L14 15" stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                  </svg>
                </span>
              </label>
              <label class="icon-option">
                <input type="radio" name="iconColor" value="orange" data-setting="iconColor">
                <span class="icon-preview">
                  <svg width="32" height="32" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <circle cx="12" cy="12" r="10" fill="#FB923C" opacity="0.85"/>
                    <path d="M8 9L11 12L8 15M14 9L17 12L14 15" stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                  </svg>
                </span>
              </label>
              <label class="icon-option">
                <input type="radio" name="iconColor" value="red" data-setting="iconColor">
                <span class="icon-preview">
                  <svg width="32" height="32" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <circle cx="12" cy="12" r="10" fill="#F87171" opacity="0.85"/>
                    <path d="M8 9L11 12L8 15M14 9L17 12L14 15" stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                  </svg>
                </span>
              </label>
              <label class="icon-option">
                <input type="radio" name="iconColor" value="teal" data-setting="iconColor">
                <span class="icon-preview">
                  <svg width="32" height="32" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <circle cx="12" cy="12" r="10" fill="#2DD4BF" opacity="0.85"/>
                    <path d="M8 9L11 12L8 15M14 9L17 12L14 15" stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                  </svg>
                </span>
              </label>
              <label class="icon-option">
                <input type="radio" name="iconColor" value="indigo" data-setting="iconColor">
                <span class="icon-preview">
                  <svg width="32" height="32" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <circle cx="12" cy="12" r="10" fill="#818CF8" opacity="0.85"/>
                    <path d="M8 9L11 12L8 15M14 9L17 12L14 15" stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                  </svg>
                </span>
              </label>
            </div>

            <div class="setting-item">
              <div class="setting-info">
                <label class="setting-label" for="wordUnderlineColor" data-i18n-key="popup.wordUnderlineColor.label">Word Underline Color</label>
              </div>
              <div class="setting-control">
                <!-- Custom Select for Word Color -->
                <div class="custom-select-wrapper" id="wordUnderlineColorSelect" data-setting="wordUnderlineColorV2">
                  <div class="custom-select-trigger">
                    <span class="color-dot" id="wordUnderlineColorPreview"></span>
                    <span class="color-name" id="wordUnderlineColorLabel">Select Color</span>
                    <span class="custom-select-arrow"></span>
                  </div>
                  <div class="custom-select-options">
                    <div class="custom-option" data-value="#2A9D8F">
                      <span class="color-dot" style="background-color: #2A9D8F;"></span>
                      <span data-i18n-key="popup.color.teal">Teal</span>
                    </div>
                    <div class="custom-option" data-value="#6366F1">
                      <span class="color-dot" style="background-color: #6366F1;"></span>
                      <span data-i18n-key="popup.color.indigo">Indigo</span>
                    </div>
                    <div class="custom-option" data-value="#0EA5E9">
                      <span class="color-dot" style="background-color: #0EA5E9;"></span>
                      <span data-i18n-key="popup.color.skyBlue">Sky Blue</span>
                    </div>
                    <div class="custom-option" data-value="#1F7FDB">
                      <span class="color-dot" style="background-color: #1F7FDB;"></span>
                      <span data-i18n-key="popup.color.standardBlue">Standard Blue</span>
                    </div>
                    <div class="custom-option" data-value="#E9C46A">
                      <span class="color-dot" style="background-color: #E9C46A;"></span>
                      <span data-i18n-key="popup.color.mustardYellow">Mustard Yellow</span>
                    </div>
                    <div class="custom-option" data-value="#F59E0B">
                      <span class="color-dot" style="background-color: #F59E0B;"></span>
                      <span data-i18n-key="popup.color.amber">Amber</span>
                    </div>
                    <div class="custom-option" data-value="#8B5CF6">
                      <span class="color-dot" style="background-color: #8B5CF6;"></span>
                      <span data-i18n-key="popup.color.softViolet">Soft Violet</span>
                    </div>
                    <div class="custom-option" data-value="#F4A261">
                      <span class="color-dot" style="background-color: #F4A261;"></span>
                      <span data-i18n-key="popup.color.goldenSand">Golden Sand</span>
                    </div>
                    <div class="custom-option" data-value="#D4A373">
                      <span class="color-dot" style="background-color: #D4A373;"></span>
                      <span data-i18n-key="popup.color.earthyOchre">Earthy Ochre</span>
                    </div>
                    <div class="custom-option" data-value="#FFB703">
                      <span class="color-dot" style="background-color: #FFB703;"></span>
                      <span data-i18n-key="popup.color.brightMarigold">Bright Marigold</span>
                    </div>
                    <div class="custom-option" data-value="#C1A162">
                      <span class="color-dot" style="background-color: #C1A162;"></span>
                      <span data-i18n-key="popup.color.mutedGold">Muted Gold</span>
                    </div>
                    <div class="custom-option" data-value="#E59E47">
                      <span class="color-dot" style="background-color: #E59E47;"></span>
                      <span data-i18n-key="popup.color.standardOrange">Standard Orange</span>
                    </div>
                  </div>
                </div>
              </div>
            </div>

            <div class="setting-item">
              <div class="setting-info">
                <label class="setting-label" for="sentenceUnderlineColor" data-i18n-key="popup.sentenceUnderlineColor.label">Sentence Underline Color</label>
              </div>
              <div class="setting-control">
                <!-- Custom Select for Sentence Color -->
                <div class="custom-select-wrapper" id="sentenceUnderlineColorSelect" data-setting="sentenceUnderlineColor">
                  <div class="custom-select-trigger">
                    <span class="color-dot" id="sentenceUnderlineColorPreview"></span>
                    <span class="color-name" id="sentenceUnderlineColorLabel">Select Color</span>
                    <span class="custom-select-arrow"></span>
                  </div>
                  <div class="custom-select-options">
                    <div class="custom-option" data-value="#2A9D8F">
                      <span class="color-dot" style="background-color: #2A9D8F;"></span>
                      <span data-i18n-key="popup.color.teal">Teal</span>
                    </div>
                    <div class="custom-option" data-value="#6366F1">
                      <span class="color-dot" style="background-color: #6366F1;"></span>
                      <span data-i18n-key="popup.color.indigo">Indigo</span>
                    </div>
                    <div class="custom-option" data-value="#0EA5E9">
                      <span class="color-dot" style="background-color: #0EA5E9;"></span>
                      <span data-i18n-key="popup.color.skyBlue">Sky Blue</span>
                    </div>
                    <div class="custom-option" data-value="#1F7FDB">
                      <span class="color-dot" style="background-color: #1F7FDB;"></span>
                      <span data-i18n-key="popup.color.standardBlue">Standard Blue</span>
                    </div>
                    <div class="custom-option" data-value="#E9C46A">
                      <span class="color-dot" style="background-color: #E9C46A;"></span>
                      <span data-i18n-key="popup.color.mustardYellow">Mustard Yellow</span>
                    </div>
                    <div class="custom-option" data-value="#F59E0B">
                      <span class="color-dot" style="background-color: #F59E0B;"></span>
                      <span data-i18n-key="popup.color.amber">Amber</span>
                    </div>
                    <div class="custom-option" data-value="#8B5CF6">
                      <span class="color-dot" style="background-color: #8B5CF6;"></span>
                      <span data-i18n-key="popup.color.softViolet">Soft Violet</span>
                    </div>
                    <div class="custom-option" data-value="#F4A261">
                      <span class="color-dot" style="background-color: #F4A261;"></span>
                      <span data-i18n-key="popup.color.goldenSand">Golden Sand</span>
                    </div>
                    <div class="custom-option" data-value="#D4A373">
                      <span class="color-dot" style="background-color: #D4A373;"></span>
                      <span data-i18n-key="popup.color.earthyOchre">Earthy Ochre</span>
                    </div>
                    <div class="custom-option" data-value="#FFB703">
                      <span class="color-dot" style="background-color: #FFB703;"></span>
                      <span data-i18n-key="popup.color.brightMarigold">Bright Marigold</span>
                    </div>
                    <div class="custom-option" data-value="#C1A162">
                      <span class="color-dot" style="background-color: #C1A162;"></span>
                      <span data-i18n-key="popup.color.mutedGold">Muted Gold</span>
                    </div>
                    <div class="custom-option" data-value="#E59E47">
                      <span class="color-dot" style="background-color: #E59E47;"></span>
                      <span data-i18n-key="popup.color.standardOrange">Standard Orange</span>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>

        <div id="advanced-settings" class="settings-section">
          <div class="section-header">
            <h2 data-i18n-key="popup.section.advanced">Advanced</h2>
          </div>

          <h3 class="card-title" id="connectionCardTitle" data-i18n-key="popup.section.network" style="margin-bottom: 12px; font-size: 16px; font-weight: 600; color: var(--text-primary); padding-left: 2px;">Connection</h3>
          <div class="card settings-card" id="connectionCard" style="margin-bottom: 32px; padding: 16px;">
            <p class="section-subtitle" data-i18n-key="popup.networkRegion.helper" style="margin: 0 0 12px 0;">Choose a specific network route to bypass connection issues.</p>
            <div class="radio-group">
              <label class="radio-card">
                <input type="radio" name="networkRegion" value="auto" data-setting="networkRegion">
                <div class="radio-info">
                  <span class="radio-title" data-i18n-key="popup.networkRegion.auto">Auto</span>
                  <span class="radio-desc" data-i18n-key="popup.networkRegion.auto.desc">Automatically detects optimal route.</span>
                </div>
              </label>
              <label class="radio-card">
                <input type="radio" name="networkRegion" value="china" data-setting="networkRegion">
                <div class="radio-info">
                  <span class="radio-title" data-i18n-key="popup.networkRegion.china">China Direct</span>
                  <span class="radio-desc" data-i18n-key="popup.networkRegion.china.desc">For users in Mainland China.</span>
                </div>
              </label>
              <label class="radio-card">
                <input type="radio" name="networkRegion" value="global" data-setting="networkRegion">
                <div class="radio-info">
                  <span class="radio-title" data-i18n-key="popup.networkRegion.global">Global</span>
                  <span class="radio-desc" data-i18n-key="popup.networkRegion.global.desc">Force connection via Cloudflare.</span>
                </div>
              </label>
            </div>
          </div>

          <div style="margin-bottom: 12px; padding-left: 2px;">
            <h3 class="card-title" data-i18n-key="popup.section.customApi" style="font-size: 16px; font-weight: 600; color: var(--text-primary); margin-bottom: 4px;">Translation Provider</h3>
            <p class="section-subtitle" data-i18n-key="popup.section.translationProvider.helper" style="margin: 0; font-size: 13px; color: var(--text-secondary);">Select which translation service to use.</p>
          </div>
          <div class="card settings-card">
            <div class="setting-item">
              <div class="setting-info">
                <label class="setting-label" for="translationProvider" data-i18n-key="popup.translationProvider.label">Translation Provider</label>
                <p class="setting-helper" data-i18n-key="popup.translationProvider.helper">Choose between official cloud API, custom LLM API, or self-hosted MTranServer.</p>
              </div>
              <div class="setting-control">
                <select id="translationProvider" data-setting="translationProvider" class="select-input">
                  <option value="official" data-i18n-key="popup.translationProvider.official">Official Cloud API</option>
                  <option value="customApi" data-i18n-key="popup.translationProvider.customApi">Custom LLM API</option>
                  <option value="mtranserver" data-i18n-key="popup.translationProvider.mtranserver">MTranServer (Self-hosted)</option>
                </select>
              </div>
            </div>
          </div>

          <div style="margin-top: 20px; margin-bottom: 12px; padding-left: 2px;">
            <h3 class="card-title" data-i18n-key="popup.section.customApi" style="font-size: 16px; font-weight: 600; color: var(--text-primary); margin-bottom: 4px;">Custom LLM API</h3>
            <p class="section-subtitle" data-i18n-key="popup.section.customApi.helper" style="margin: 0; font-size: 13px; color: var(--text-secondary);">Use your own LLM API provider for translations.</p>
          </div>
          <div class="card settings-card" id="customApiCard">
            <div class="setting-item">
              <div class="setting-info">
                <label class="setting-label" for="customApiBaseUrl" data-i18n-key="popup.customApi.baseUrl.label">API Base URL</label>
                <p class="setting-helper" data-i18n-key="popup.customApi.baseUrl.helper">Example: https://api.openai.com/v1</p>
              </div>
              <div class="setting-control">
                <input type="url" id="customApiBaseUrl" data-setting="customApiBaseUrl" data-custom-api-control="true" class="select-input" placeholder="https://api.example.com/v1" />
              </div>
            </div>

            <div class="setting-item">
              <div class="setting-info">
                <label class="setting-label" for="customApiKey" data-i18n-key="popup.customApi.apiKey.label">API Key</label>
                <p class="setting-helper" data-i18n-key="popup.customApi.apiKey.helper">Your provider token (stored locally in browser storage).</p>
              </div>
              <div class="setting-control">
                <input type="password" id="customApiKey" data-setting="customApiKey" data-custom-api-control="true" class="select-input" placeholder="sk-..." autocomplete="new-password" />
              </div>
            </div>

            <div class="setting-item">
              <div class="setting-info">
                <label class="setting-label" for="customApiModel" data-i18n-key="popup.customApi.model.label">Model</label>
                <p class="setting-helper" data-i18n-key="popup.customApi.model.helper">Example: gpt-4o-mini, qwen-plus</p>
              </div>
              <div class="setting-control">
                <input type="text" id="customApiModel" data-setting="customApiModel" data-custom-api-control="true" class="select-input" placeholder="model-name" />
              </div>
            </div>

            <div class="setting-item">
              <div class="setting-info">
                <label class="setting-label" for="validateCustomApiButton" data-i18n-key="popup.customApi.validate.label">Validate Settings</label>
                <p class="setting-helper" data-i18n-key="popup.customApi.validate.helper">Run a quick test translation using your custom API.</p>
              </div>
              <div class="setting-control validation-control">
                <button class="secondary-button" id="validateCustomApiButton" data-custom-api-control="true" data-i18n-key="popup.customApi.validate.button">Validate</button>
                <p class="validation-status" id="validateCustomApiStatus"></p>
              </div>
            </div>
          </div>

          <div style="margin-top: 20px; margin-bottom: 12px; padding-left: 2px;">
            <h3 class="card-title" style="font-size: 16px; font-weight: 600; color: var(--text-primary); margin-bottom: 4px;">MTranServer</h3>
            <p class="section-subtitle" style="margin: 0; font-size: 13px; color: var(--text-secondary);">
              <span data-i18n-key="popup.mtranserver.description">A lightweight, self-hosted translation service with low resource consumption.</span>
              <a href="https://github.com/xxnuo/MTranServer" target="_blank" rel="noopener noreferrer" class="link" data-i18n-key="popup.mtranserver.learnMore">Learn more →</a>
            </p>
          </div>
          <div class="card settings-card" id="mtranserverCard">
            <div class="setting-item">
              <div class="setting-info">
                <label class="setting-label" for="mtranserverUrl" data-i18n-key="popup.mtranserver.url.label">MTranServer URL</label>
                <p class="setting-helper" data-i18n-key="popup.mtranserver.url.helper">Your self-hosted MTranServer endpoint (e.g., http://127.0.0.1:8989).</p>
              </div>
              <div class="setting-control">
                <input type="url" id="mtranserverUrl" data-setting="mtranserverUrl" class="select-input" placeholder="http://127.0.0.1:8989" value="http://127.0.0.1:8989"/>
              </div>
            </div>

            <div class="setting-item">
              <div class="setting-info">
                <label class="setting-label" for="mtranserverKey" data-i18n-key="popup.mtranserver.key.label">API Key (Optional)</label>
                <p class="setting-helper" data-i18n-key="popup.mtranserver.key.helper">If your MTranServer requires authentication.</p>
              </div>
              <div class="setting-control">
                <input type="password" id="mtranserverKey" data-setting="mtranserverKey" class="select-input" placeholder="" value=""/>
              </div>
            </div>

            <div class="setting-item">
              <div class="setting-info">
                <label class="setting-label" data-i18n-key="popup.mtranserver.test.label">Test Connection</label>
                <p class="setting-helper" data-i18n-key="popup.mtranserver.test.helper">Test your MTranServer connection with a sample translation.</p>
              </div>
              <div class="setting-control validation-control">
                <button class="secondary-button" id="testMtranserverButton" data-i18n-key="popup.mtranserver.test.button">Test Translation</button>
                <p class="validation-status" id="testMtranserverStatus"></p>
              </div>
            </div>
          </div>
        </div>
      </section>
    </main>
  </div>
  <script type="module" src="index.ts"></script>
</body>
</html>